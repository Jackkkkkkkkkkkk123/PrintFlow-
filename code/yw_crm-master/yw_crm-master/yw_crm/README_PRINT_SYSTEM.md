# 印刷订单管理系统

## 系统概述

这是一个基于Django的印刷订单管理系统，支持从Excel文件创建订单，管理封面印刷和内文印刷两种流程，每个进度需要手动确认，并支持随机进入下一个阶段。

## 主要功能

### 1. 订单管理
- 从Excel文件批量创建印刷订单
- 查看订单列表和详情
- 订单状态跟踪（待处理、处理中、已完成、已取消）

### 2. 印刷流程管理
- **封面印刷流程**：材料准备 → 版面设计 → 印刷调试 → 正式印刷 → 质量检查 → 包装入库
- **内文印刷流程**：纸张准备 → 内容排版 → 印刷调试 → 正式印刷 → 质量检查 → 装订检查 → 包装入库

### 3. 进度管理
- 每个步骤需要手动确认完成
- 支持随机选择下一个待确认的步骤
- 实时显示进度百分比
- 记录确认时间和确认人

### 4. 仪表板
- 统计信息展示（总订单数、待处理、处理中、已完成）
- 最近订单列表
- 进行中的流程监控

## 安装和运行

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 数据库迁移
```bash
python manage.py makemigrations
python manage.py migrate
```

### 3. 创建超级用户
```bash
python manage.py createsuperuser
```

### 4. 运行服务器
```bash
python manage.py runserver
```

## 使用说明

### 1. 创建订单
1. 访问 `/print-orders/create/`
2. 上传包含订单信息的Excel文件
3. Excel文件应包含以下列：
   - 客户名称
   - 产品名称
   - 数量
   - 交货日期（可选）

### 2. 查看订单
1. 访问 `/print-orders/` 查看订单列表
2. 点击"查看详情"查看订单详细信息
3. 在订单详情页面可以看到两个印刷流程的进度

### 3. 管理进度
1. 在订单详情页面点击"管理进度"
2. 系统会显示当前待确认的步骤
3. 点击"确认完成"按钮确认步骤
4. 系统会随机选择下一个待确认的步骤

### 4. 仪表板
1. 访问 `/print-dashboard/` 查看系统概览
2. 查看统计信息和最近订单
3. 监控进行中的流程

## 系统特点

### 1. 随机进度确认
- 每个步骤完成后，系统会随机选择下一个待确认的步骤
- 确保流程的灵活性和适应性

### 2. 手动确认机制
- 每个步骤都需要手动确认
- 记录确认时间和确认人
- 防止遗漏和错误

### 3. 实时进度跟踪
- 实时显示每个流程的完成百分比
- 清晰的状态标识
- 详细的进度历史记录

### 4. 双流程支持
- 封面印刷和内文印刷两个独立流程
- 每个流程有专门的步骤和进度管理
- 支持并行处理

## 文件结构

```
crm/
├── models.py          # 数据模型定义
├── views.py           # 视图函数
├── migrations/        # 数据库迁移文件
└── templates/         # 模板文件
    ├── print_order_list.html      # 订单列表页面
    ├── create_print_order.html    # 创建订单页面
    ├── print_order_detail.html    # 订单详情页面
    ├── print_progress.html        # 进度管理页面
    └── print_dashboard.html       # 仪表板页面
```

## API接口

### 1. 创建订单
- URL: `/print-orders/create/`
- 方法: POST
- 参数: Excel文件
- 返回: JSON格式的创建结果

### 2. 确认步骤
- URL: `/confirm-step/<step_id>/`
- 方法: POST
- 返回: JSON格式的确认结果和下一个步骤

### 3. 订单列表
- URL: `/print-orders/`
- 方法: GET
- 返回: 订单列表页面

### 4. 订单详情
- URL: `/print-orders/<order_id>/`
- 方法: GET
- 返回: 订单详情页面

### 5. 进度管理
- URL: `/print-progress/<process_id>/`
- 方法: GET
- 返回: 进度管理页面

### 6. 仪表板
- URL: `/print-dashboard/`
- 方法: GET
- 返回: 仪表板页面

## 注意事项

1. **Excel文件格式**：确保Excel文件包含必要的列名
2. **权限控制**：系统使用Django的权限系统，确保用户有相应权限
3. **数据备份**：定期备份数据库数据
4. **浏览器兼容性**：建议使用现代浏览器（Chrome、Firefox、Safari）

## 扩展功能

系统支持以下扩展：
- 添加更多印刷流程类型
- 集成条码扫描功能
- 添加邮件通知功能
- 集成移动端应用
- 添加报表统计功能 